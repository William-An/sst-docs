<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-elements/ember/QuickStart">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.1.0">
<title data-rh="true">What is an Ember Motif? | The Structural Simulation Toolkit</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://sstsimulator.github.io/sst-website/img/sst-logo-small.png"><meta data-rh="true" name="twitter:image" content="https://sstsimulator.github.io/sst-website/img/sst-logo-small.png"><meta data-rh="true" property="og:url" content="https://sstsimulator.github.io/sst-website/docs/elements/ember/QuickStart"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="What is an Ember Motif? | The Structural Simulation Toolkit"><meta data-rh="true" name="description" content="Ember Motifs provide representative workloads and then estimate performance on hardware using SST simulations."><meta data-rh="true" property="og:description" content="Ember Motifs provide representative workloads and then estimate performance on hardware using SST simulations."><link data-rh="true" rel="icon" href="/sst-website/img/favicon.png"><link data-rh="true" rel="canonical" href="https://sstsimulator.github.io/sst-website/docs/elements/ember/QuickStart"><link data-rh="true" rel="alternate" href="https://sstsimulator.github.io/sst-website/docs/elements/ember/QuickStart" hreflang="en"><link data-rh="true" rel="alternate" href="https://sstsimulator.github.io/sst-website/docs/elements/ember/QuickStart" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/sst-website/blog/rss.xml" title="The Structural Simulation Toolkit RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/sst-website/blog/atom.xml" title="The Structural Simulation Toolkit Atom Feed">




<script src="https://buttons.github.io/buttons.js"></script><link rel="stylesheet" href="/sst-website/assets/css/styles.8575e60e.css">
<link rel="preload" href="/sst-website/assets/js/runtime~main.27525ba2.js" as="script">
<link rel="preload" href="/sst-website/assets/js/main.3a6bd8a4.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="theme.common.skipToMainContent"><a href="#" class="skipToContent_fXgn">Skip to main content</a></div><nav class="navbar navbar--fixed-top navbar--primary"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/sst-website/"><div class="navbar__logo"><img src="/sst-website/img/sst-logo-small.png" alt="" class="themedImage_ToTc themedImage--light_HNdA"><img src="/sst-website/img/sst-logo-small.png" alt="" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">The Structural Simulation Toolkit</b></a><a href="https://sstsimulator.github.io" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Main<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><a class="navbar__item navbar__link" href="/sst-website/docs/guides/external/projectDriver">Guides</a><a class="navbar__item navbar__link" href="/sst-website/docs/cpp/component/constructor">SST-Core API</a><a class="navbar__item navbar__link" href="/sst-website/docs/guides/external/projectDriver">Configuration</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/sst-website/docs/elements/ember/QuickStart">Elements</a><a class="navbar__item navbar__link" href="/sst-website/docs/tools/commandLine/sst-info">Tools</a><a class="navbar__item navbar__link" href="/sst-website/help">Help</a></div><div class="navbar__items navbar__items--right"><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebar_njMd"><nav class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/sst-website/docs/projectDriver/helpUs">Contribute</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" href="/sst-website/docs/elements/ember/QuickStart">Ember</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/sst-website/docs/elements/ember/QuickStart">What is an Ember Motif?</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/sst-website/docs/elements/ember/CreatingMotifs">C++ Ember Motifs</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/sst-website/docs/elements/ember/RunningMotifs">Ember Python Configurations</a></li></ul></li></ul></nav></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/sst-website/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_OVgt"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Ember</span><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">What is an Ember Motif?</span><meta itemprop="position" content="2"></li></ul></nav><div class="theme-doc-markdown markdown"><h1>What is an Ember Motif?</h1><p>Ember Motifs provide representative workloads and then estimate performance on hardware using SST simulations.
This guide provides a directions on how to:</p><ul><li>Implement a empty motif.</li><li>Create and run motif in a SST simulation.</li></ul><p>Implementing and running Ember Motifs requires three different files:</p><ol><li>Python File
Provides information on the hardware to be simulated when running an Ember Motif
This directs SST on the available hardware components and how they are set up.</li><li>C++ file
Decides how the computation is structured and computed.</li><li>C++ header file
The header file contains primarily naming information</li></ol><h1>Quick Start Guide</h1><p>This guide gives a simple example of how to create and run a simple Motif.</p><p>First ensure SST-core and SST-elements are properly installed on your machine. For download and installation see <a href="http://sst-simulator.org/SSTPages/SSTMainDownloads/" target="_blank" rel="noopener noreferrer">SST-Downloads</a>.</p><p>Navigate to <code>sst-elements/src/elements/ember</code> inside the sst-elements library.
First, create a new directory to hold our example Motif.</p><p><code>mkdir ExampleMotif</code></p><p>Next, create a <code>ExampleMotif/exampleMotif.h</code> file</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">    #ifndef _H_EMBER_EXAMPLE</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    #define _H_EMBER_EXAMPLE</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    #include &quot;../../mpi/embermpigen.h&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    namespace SST {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    namespace Ember {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    class ExampleGenerator : public EmberMessagePassingGenerator {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">       public:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        SST_ELI_REGISTER_SUBCOMPONENT_DERIVED(</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          Example,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          &quot;ember&quot;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          &quot;ExampleMotif&quot;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">           SST_ELI_ELEMENT_VERSION(1,0,0),</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          &quot;Performs an idle on the node, no traffic can be generated.&quot;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          SST::Ember::EmberGenerator</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    );</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        SST_ELI_DOCUMENT_PARAMS(</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        );</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        SST_ELI_DOCUMENT_STATISTICS(</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          { &quot;time-Init&quot;, &quot;Time spent in Init event&quot;,             &quot;ns&quot;, 0},</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          { &quot;time-Finalize&quot;, &quot;Time spent in Finalize event&quot;,     &quot;ns&quot;, 0},</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          { &quot;time-Rank&quot;, &quot;Time spent in Rank event&quot;,             &quot;ns&quot;, 0},</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          { &quot;time-Size&quot;, &quot;Time spent in Size event&quot;,             &quot;ns&quot;, 0},</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          { &quot;time-Send&quot;, &quot;Time spent in Recv event&quot;,             &quot;ns&quot;, 0},</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          { &quot;time-Recv&quot;, &quot;Time spent in Recv event&quot;,             &quot;ns&quot;, 0},</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          { &quot;time-Irecv&quot;, &quot;Time spent in Irecv event&quot;,           &quot;ns&quot;, 0},</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          { &quot;time-Isend&quot;, &quot;Time spent in Isend event&quot;,           &quot;ns&quot;, 0},</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          { &quot;time-Wait&quot;, &quot;Time spent in Wait event&quot;,             &quot;ns&quot;, 0},</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          { &quot;time-Waitall&quot;, &quot;Time spent in Waitall event&quot;,       &quot;ns&quot;, 0},</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          { &quot;time-Waitany&quot;, &quot;Time spent in Waitany event&quot;,       &quot;ns&quot;, 0},</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          { &quot;time-Compute&quot;, &quot;Time spent in Compute event&quot;,       &quot;ns&quot;, 0},</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          { &quot;time-Barrier&quot;, &quot;Time spent in Barrier event&quot;,       &quot;ns&quot;, 0},</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          { &quot;time-Alltoallv&quot;, &quot;Time spent in Alltoallv event&quot;,   &quot;ns&quot;, 0},</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          { &quot;time-Alltoall&quot;, &quot;Time spent in Alltoall event&quot;,     &quot;ns&quot;, 0},</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          { &quot;time-Allreduce&quot;, &quot;Time spent in Allreduce event&quot;,   &quot;ns&quot;, 0},</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          { &quot;time-Reduce&quot;, &quot;Time spent in Reduce event&quot;,         &quot;ns&quot;, 0},</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          { &quot;time-Bcast&quot;, &quot;Time spent in Bcast event&quot;,           &quot;ns&quot;, 0},</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          { &quot;time-Gettime&quot;, &quot;Time spent in Gettime event&quot;,       &quot;ns&quot;, 0},</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          { &quot;time-Commsplit&quot;, &quot;Time spent in Commsplit event&quot;,   &quot;ns&quot;, 0},</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          { &quot;time-Commcreate&quot;, &quot;Time spent in Commcreate event&quot;, &quot;ns&quot;, 0},</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        );</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    };</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    #endif /* _H_EMBER_EXAMPLE */</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>This creates a Motif generator class called ExampleGenerator that inherits from EmberMessagePassingGenerator. The Python code we provide later creates and invokes the generate function.
The SST Document Statistics provides tracking for initialization and various MPI function calls.</p><p>Motifs are executed as follows:</p><p>1) The motif generator is initialized (The contructor)
2) The generate function is invoked and returns either true or false
3) The events on the eventQueue are processed.
4) If the generate function in step 2 returned false, return to step 2, otherwise the motif is complete.</p><p>Here is a motif that returns without doing any additional work.</p><p>Then we create a file <code>ExampleMotif/Example.cc</code> with the contents:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">    #include &lt;sst_config.h&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    #include &quot;Example.h&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    using namespace SST:Ember;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    ExampleGenerator::ExampleGenerator(SST::ComponentId_t id, Params&amp; params) :</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            EmberMessagePassingGenerator(id, params, &quot;Null&quot; )</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    bool ExampleGenerator::generate( std::queue&lt;EmberEvent*&gt;&amp; evQ)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    { </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        // Code here is repeated until true is returned. </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        return true;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Motifs are intended to be ran as a &#x27;job submission&#x27;.
The generate function models an entire iteration of an application. The event queue allows the motif to mix compute and MPI operations in every iteration.</p><p>The C++ file loads the SST:Ember namespace giving it access to other Motifs and EmberEvents.
Each Motif generator has an constructor and generate function. </p><p>Then we add the <code>.cc</code> and <code>.h</code> file to <code>Makefile.am</code></p><p>i.e.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">     embermemoryev.h \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     ExampleMotif/example.h \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     ExampleMotif/example.cc \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     libs/emberLib.h \</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Finally, a python file <code>example.py</code> needs to be created:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">    from email.mime import base</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    import sst</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    from sst.merlin.base import *</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    from sst.merlin.endpoint import *</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    from sst.merlin.interface import *</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    from sst.merlin.topology import *</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    from sst.ember import *</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    def example():</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        PlatformDefinition.setCurrentPlatform(&quot;firefly-defaults&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        ### Setup the topology</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        topo = topoDragonFly()</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        topo.hosts_per_router = 2</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        topo.routers_per_group = 4</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        topo.intergroup_links = 2</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        topo.num_groups = 4</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        topo.algorithm = [&quot;minimal&quot;,&quot;adaptive-local&quot;]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        # Set up the routers</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        router = hr_router()</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        router.link_bw = &quot;4GB/s&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        router.flit_size = &quot;8B&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        router.xbar_bw = &quot;6GB/s&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        router.input_latency = &quot;20ns&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        router.output_latency = &quot;20ns&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        router.input_buf_size = &quot;4kB&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        router.output_buf_size = &quot;4kB&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        router.num_vns = 2</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        router.xbar_arb = &quot;merlin.xbar_arb_lru&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        topo.router = router</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        topo.link_latency = &quot;20ns&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        ### set up the endpoint</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        networkif = ReorderLinkControl()</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        networkif.link_bw = &quot;4GB/s&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        networkif.input_buf_size = &quot;1kB&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        networkif.output_buf_size = &quot;1kB&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        ep = EmberMPIJob(0,topo.getNumNodes())</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        ep.network_interface = networkif</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        ep.addMotif(&quot;Example&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        ep.nic.nic2host_lat= &quot;100ns&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        system = System()</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        system.setTopology(topo)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        system.allocateNodes(ep,&quot;linear&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        system.build()</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    if __name__ == &quot;__main__&quot;:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        example()</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>This follows common python syntax.
The hardware variables (topology, router and network interface) are created through assignment of a constructor
The fields of the variables are accessed using a dot operator.
Topology, router, and network interface variables need to be created for a simulation. More detailed descriptions of configuration options is in RunningMotifs.md.
Next an endpoint is created and given the motif to be used using a ep.addMotif(&quot;MotifName&quot;)call
Note multiple motifs can be added the same endpoint. The intended use for each motif to simulate an entire application. The event queue is used to simulate MPI events and computational workloads. Adding multiple motifs is useful for simulating workflows of a series of applications. </p><p>Finally, a system variable is created and &#x27;built&#x27;</p><p>Remake SST-elements.</p><p>To run the python script</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">sst example.py</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/sstsimulator/sst-website/edit/master/docs/../docs/elements/ember/QuickStart.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_vwxv"><span class="theme-last-updated">Last updated<!-- --> on <b><time datetime="2022-10-14T18:16:28.000Z">Oct 14, 2022</time></b> by <b>Joseph Kenny</b></span></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/sst-website/docs/projectDriver/helpUs"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Help Us</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/sst-website/docs/elements/ember/CreatingMotifs"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">C++ Ember Motifs</div></a></nav></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="margin-bottom--sm"><img src="/sst-website/img/sst-logo-small.png" class="themedImage_ToTc themedImage--light_HNdA footer__logo"><img src="/sst-website/img/sst-logo-small.png" class="themedImage_ToTc themedImage--dark_i4oU footer__logo"></div><div class="footer__copyright">Copyright © 2022 SST</div></div></div></footer></div>
<script src="/sst-website/assets/js/runtime~main.27525ba2.js"></script>
<script src="/sst-website/assets/js/main.3a6bd8a4.js"></script>
</body>
</html>